import{_ as s,c as a,e as p,o as e}from"./app-34Y0emjC.js";const t={};function l(c,n){return e(),a("div",null,[...n[0]||(n[0]=[p(`<h1 id="vite" tabindex="-1"><a class="header-anchor" href="#vite"><span>Vite</span></a></h1><blockquote><p>æ˜¯ä¸€ç§æ–°å‹å‰ç«¯æ„å»ºå·¥å…·ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡å‰ç«¯å¼€å‘ä½“éªŒ</p></blockquote><h2 id="éœ€æ±‚" tabindex="-1"><a class="header-anchor" href="#éœ€æ±‚"><span>éœ€æ±‚</span></a></h2><blockquote><p>å»ºä¸€ä¸ªåŒæ—¶æ”¯æŒvue2æŠ€æœ¯æ ˆã€vue3æŠ€æœ¯æ ˆã€reactæŠ€æœ¯æ ˆçš„Monorepoé¡¹ç›®</p></blockquote><ul><li>æ¯ä¸€ä¸­è¯­è¨€æ–‡ä»¶å¤¹ä¸‹modulesä¸‹çš„æ¯ä¸€ä¸ªæ–‡ä»¶å¤¹éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®(å½“å‰é¡¹ç›®çš„è·¯å¾„ã€å½“å‰é¡¹ç›®çš„ç»„ä»¶ã€å½“å‰é¡¹ç›®çš„vuexæˆ–pinia)</li><li>dev serveåªèƒ½è¿è¡Œä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„å…¥å£ts</li><li>ç”±äºviteå¯¹åº”ä¸åŒè¯­è¨€æœ‰ä¸åŒçš„æ’ä»¶ï¼Œå¹¶ä¸”ä¸æ˜¯ä¸€ä¸ªå…¥å£æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªviteé…ç½®ï¼Œè€Œæ˜¯æ‰€æœ‰å…¥å£æ–‡ä»¶æ‰§è¡Œä¸€ä¸ªé…ç½®ï¼Œæ‰€ä»¥æ¯æ¬¡buildåªèƒ½åšåˆ°ç¼–è¯‘ä¸€ä¸ªé¡¹ç›®æˆ–è€…ç¼–è¯‘ä¸€ç§è¯­è¨€ä¸‹çš„æ‰€æœ‰é¡¹ç›®ã€‚</li></ul><h2 id="æ”¯æŒå¤šé¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#æ”¯æŒå¤šé¡¹ç›®"><span>æ”¯æŒå¤šé¡¹ç›®</span></a></h2><ul><li>é¡¹ç›®éƒ½æ”¾åœ¨/packages/ç›®å½•ä¸‹</li><li>æ ¹ç›®å½•å¯ä»¥æŒ‰ç…§å…¬å…±ä¾èµ–viteã€tsã€axiosç­‰</li><li>å„ä¸ªé¡¹ç›®å¯ä»¥å»ºç«‹è‡ªå·±çš„package.json,å¹¶ä¸”æŒ‰ç…§è‡ªå·±çš„ä¾èµ–vue@2.7+vue-router/vue@^3+vue-router</li><li>æ ¹ç›®å½•package.jsonè®¾ç½® - npm pnpm cnpm éƒ½ä¼šè¯»å–ä½¿ç”¨ï¼Œä½†æ˜¯ä¸“æ³¨ä½¿ç”¨pnpmä¼šå½±å“æ€§èƒ½</li></ul><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;workspaces&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token string">&quot;packages/*&quot;</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ–°å»ºpnpm-workspace.yaml</li></ul><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">packages</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token punctuation">-</span> <span class="token string">&quot;packages/*&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é¡¹ç›®ç›®å½•" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ç›®å½•"><span>é¡¹ç›®ç›®å½•</span></a></h2><div class="language-cmd line-numbers-mode" data-highlighter="prismjs" data-ext="cmd"><pre><code class="language-cmd"><span class="line">â”‚  .gitignore</span>
<span class="line">â”‚  index-template.html   // buildå¤šå…¥å£æ¨¡æ¿æ–‡ä»¶</span>
<span class="line">â”‚  index.html            // devå…¥å£æ–‡ä»¶</span>
<span class="line">â”‚  package.json</span>
<span class="line">â”‚  pnpm-lock.yaml</span>
<span class="line">â”‚  pnpm-workspace.yaml</span>
<span class="line">â”‚  vite.config.js        // viteé…ç½®</span>
<span class="line">â”‚</span>
<span class="line">â””â”€packages</span>
<span class="line">    â””â”€vue2</span>
<span class="line">        â”‚  package.json  // vue2å­é¡¹ç›®çš„ä¾èµ–åŒ…æ–‡ä»¶</span>
<span class="line">        â”‚  pnpm-lock.yaml</span>
<span class="line">        â”‚  tsconfig.json // vue2å­é¡¹ç›®çš„tsé…ç½®</span>
<span class="line">        â”‚</span>
<span class="line">        â””â”€modules</span>
<span class="line">            â”‚  shims-vue.d.ts  // tsè¯†åˆ«vueæ–‡ä»¶</span>
<span class="line">            â”‚</span>
<span class="line">            â”œâ”€about</span>
<span class="line">            â”‚      App.vue</span>
<span class="line">            â”‚      index.ts</span>
<span class="line">            â”‚</span>
<span class="line">            â””â”€home</span>
<span class="line">                   App.vue</span>
<span class="line">                   index.ts</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä»£ç è§£æ" tabindex="-1"><a class="header-anchor" href="#ä»£ç è§£æ"><span>ä»£ç è§£æ</span></a></h2><h3 id="ä½¿ç”¨defineconfigå‡½æ•°-ä¼ å…¥å‡½æ•°-è¿”å›viteé…ç½®" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨defineconfigå‡½æ•°-ä¼ å…¥å‡½æ•°-è¿”å›viteé…ç½®"><span>ä½¿ç”¨defineConfigå‡½æ•°ï¼Œä¼ å…¥å‡½æ•°ï¼Œè¿”å›viteé…ç½®</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite&quot;</span>   <span class="token comment">// viteè®¾ç½®é»˜è®¤é…ç½®</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>command<span class="token punctuation">,</span> mode<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// command:æ˜¯å¦æ˜¯å¯åŠ¨æœåŠ¡</span></span>
<span class="line">    <span class="token comment">// mode: å¼€å‘è¿˜æ˜¯ç”Ÿäº§ï¼ˆdevè¿˜æ˜¯proï¼‰</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// viteæœ€ç»ˆçš„é…ç½®</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ ¹æ®ç¯å¢ƒå˜é‡å’Œè¿è¡Œé¡¹ç›®åˆ¤æ–­æ˜¯å¦æ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#æ ¹æ®ç¯å¢ƒå˜é‡å’Œè¿è¡Œé¡¹ç›®åˆ¤æ–­æ˜¯å¦æ‰§è¡Œ"><span>æ ¹æ®ç¯å¢ƒå˜é‡å’Œè¿è¡Œé¡¹ç›®åˆ¤æ–­æ˜¯å¦æ‰§è¡Œ</span></a></h3><h4 id="devå¿…é¡»æŒ‡å®šå­˜åœ¨çš„ä¸€ä¸ªé¡¹ç›®ånpm-run-dev-home" tabindex="-1"><a class="header-anchor" href="#devå¿…é¡»æŒ‡å®šå­˜åœ¨çš„ä¸€ä¸ªé¡¹ç›®ånpm-run-dev-home"><span>devå¿…é¡»æŒ‡å®šå­˜åœ¨çš„ä¸€ä¸ªé¡¹ç›®ånpm run dev -- --home</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> fg <span class="token keyword">from</span> <span class="token string">&quot;fast-glob&quot;</span>   <span class="token comment">// é€’å½’è¯»å–è·¯å¾„è§„åˆ™ï¼Œè¿”å›è·¯å¾„æ•°ç»„ï¼Œå¯å¼‚æ­¥ï¼Œå¯åŒæ­¥(fg.sync)</span></span>
<span class="line"><span class="token keyword">const</span> langs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;vue2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;vue3&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å½“å‰é¡¹ç›®æ”¯æŒçš„è¯­è¨€</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// å°è£…ä¸€ä¸ªæŠ¥é”™å‡½æ•°</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">throwError</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">\\nğŸš¨ [Vite Config] </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>msg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// // ä½¿ç”¨éé›¶é€€å‡ºç è¡¨ç¤ºå¤±è´¥</span></span>
<span class="line">    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>command<span class="token punctuation">,</span> mode<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> argvs <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// å½“å‰é¡¹ç›®moduleä¸‹æ¯ä¸ªæ–‡ä»¶å¤¹éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹é¡¹ç›®ï¼Œæ‰€ä»¥å¯åŠ¨å¿…é¡»æŒ‡å®šmoudleï¼Œæ‰§è¡Œnpm run dev -- --home</span></span>
<span class="line">    <span class="token keyword">let</span> last_argv <span class="token operator">=</span> argvs<span class="token punctuation">[</span>argvs<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// process.argvè¿”å›å½“å‰å‘½ä»¤çš„è·¯å¾„æˆ–è€…å‚æ•°ï¼Œä»æœ€åä¸€ä¸ªå…ƒç´ è·å–æ‰“åŒ…æˆ–è€…ç¼–è¯‘çš„moduleName</span></span>
<span class="line">    <span class="token keyword">let</span> moduleName <span class="token operator">=</span> last_argv<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;--&quot;</span><span class="token punctuation">)</span> <span class="token operator">?</span> last_argv<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^--</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span> <span class="token comment">// å»æ‰--</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>command <span class="token operator">===</span> <span class="token string">&#39;serve&#39;</span> <span class="token operator">&amp;&amp;</span> mode <span class="token operator">===</span> <span class="token string">&#39;development&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>moduleName<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">throwError</span><span class="token punctuation">(</span><span class="token string">&quot;é”™è¯¯ï¼šå¼€å‘ç¯å¢ƒå¯åŠ¨æœåŠ¡å™¨å¿…é¡»æŒ‡å®šæ¨¡å—å¯åŠ¨ï¼Œä¾‹å¦‚ï¼šnpm run dev -- --my&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">const</span> dirs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">checkScript</span><span class="token punctuation">(</span>moduleName<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ ¡éªŒæ‰§è¡Œçš„å‘½ä»¤æ˜¯å¦æ­£ç¡®</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// æ ¡éªŒå‘½ä»¤æ‰§è¡Œæ˜¯å¦æ­£ç¡®</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">checkScript</span> <span class="token punctuation">(</span><span class="token parameter">moduleName</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// è·å–æ‰€æœ‰å…¥å£tsæ–‡ä»¶ï¼Œå¦‚æœæ‰§è¡Œmoduleï¼Œé‚£å°±å…¨å±€æŸ¥æ‰¾</span></span>
<span class="line">    <span class="token keyword">let</span> dirReg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;./packages/*/modules/*/index.ts&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œæœ€å¥½æ•°ç»„ï¼ŒåæœŸä¸ç¡®å®šä¸€å®šæ˜¯tsåç¼€ï¼Œæ‰€ä»¥å¯èƒ½æœ‰å¤šä¸ªå€¼ï¼›</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>moduleName<span class="token punctuation">)</span> dirReg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">./packages/*/modules/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>moduleName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.ts</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// æ•°ç»„ï¼šç†ç”±åŒä¸Šï¼›</span></span>
<span class="line">    <span class="token keyword">const</span> dirs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fg</span><span class="token punctuation">(</span>dirReg<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è·å–è·¯å¾„åˆ—è¡¨</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dirs<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">throwError</span><span class="token punctuation">(</span><span class="token string">&quot;é”™è¯¯ï¼šæœªæ‰¾åˆ°éœ€è¦æ‰“åŒ…è¿è¡Œçš„æ–‡ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// æ ¹æ®é¡¹ç›®æ”¯æŒè¯­è¨€æ•°ç»„ç”Ÿæˆè¯­è¨€æ­£åˆ™---è¦æ±‚æ¯ä¸ªå­é¡¹ç›®æ–‡ä»¶åå¿…é¡»å¸¦è¯­è¨€å³å¯ä»¥æ˜¯packages/vue2ä¹Ÿå¯ä»¥æ˜¯packages/vue2-xxx,ä¸èƒ½æ˜¯packages/v2(é€»è¾‘ä¸è®¤)</span></span>
<span class="line">    <span class="token keyword">let</span> langReg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>langs<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dirs<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token operator">=&gt;</span>langReg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">throwError</span><span class="token punctuation">(</span><span class="token string">&quot;é”™è¯¯ï¼šéœ€è¦æ‰“åŒ…çš„tsæ–‡ä»¶è·¯å¾„æœªå£°æ˜å¼€å‘æ¡†æ¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// æš‚æ²¡æƒ³åˆ°ä¸€æ¬¡buildå¤šç§è¯­è¨€ï¼Œæš‚æ—¶åªå®ç°æ‰“ä¸€æ¬¡</span></span>
<span class="line">    <span class="token comment">// æ ¹æ®æ”¯æŒè¯­è¨€æ•°ç»„ï¼Œç”Ÿæˆæ ¡éªŒè¯­è¨€çš„æ­£åˆ™æ•°ç»„</span></span>
<span class="line">    <span class="token keyword">let</span> langArrReg <span class="token operator">=</span> langs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token operator">=&gt;</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// è·å–å½“å‰æ‰€ä»¥å…¥å£æ–‡ä»¶ä½¿ç”¨&#39;,&#39;æ‹¼æ¥çš„å­—ç¬¦ä¸²</span></span>
<span class="line">    <span class="token keyword">let</span> dirstr <span class="token operator">=</span> dirs<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// ä½¿ç”¨reduceè·å–åˆ°å…¥å£æ–‡ä»¶æ•°ç»„åŒ…å«çš„è¯­è¨€æ•°é‡</span></span>
<span class="line">    <span class="token comment">// 0ä¸ºåˆå§‹å€¼ï¼Œpreä¸ºåˆå§‹å€¼/ä¸Šä¸€æ¬¡è¿”å›çš„å€¼,(pre += (cur.test(dirstr) - 0), pre),&#39;,&#39;è¿æ¥çš„è¡¨è¾¾å¼ï¼Œreturnæœ€åä¸€ä¸ªå€¼ï¼›</span></span>
<span class="line">    <span class="token comment">// (cur.test(dirstr) - 0)  true - 0 = 1;</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>langArrReg<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span>pre <span class="token operator">+=</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>dirstr<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pre<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">throwError</span><span class="token punctuation">(</span><span class="token string">&quot;é”™è¯¯ï¼šä¸€æ¬¡åªèƒ½åŒæ—¶æ‰“åŒ…ä¸€ç§è¯­è¨€&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">return</span> dirs</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è¿è¡Œdevæ—¶è‡ªåŠ¨ç»™æ ¹ç›®å½•index-htmlçš„scriptå¼•å…¥æŒ‡å®šmoduleçš„tsæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#è¿è¡Œdevæ—¶è‡ªåŠ¨ç»™æ ¹ç›®å½•index-htmlçš„scriptå¼•å…¥æŒ‡å®šmoduleçš„tsæ–‡ä»¶"><span>è¿è¡Œdevæ—¶è‡ªåŠ¨ç»™æ ¹ç›®å½•index.htmlçš„scriptå¼•å…¥æŒ‡å®šmoduleçš„tsæ–‡ä»¶</span></a></h3><ul><li>ä¸å¸Œæœ›å‡ºç°æ–‡ä»¶æ›´æ”¹ï¼Œåšå¥½çš„ç‰ˆæœ¬æ˜¯é€šè¿‡å˜é‡ä¼ é€’</li><li>å˜é‡ä»…å½“å‰è¿›ç¨‹æœ‰æ•ˆ</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>command<span class="token punctuation">,</span> mode<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>command <span class="token operator">===</span> <span class="token string">&#39;serve&#39;</span> <span class="token operator">&amp;&amp;</span> mode <span class="token operator">===</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// å¦‚æœå¼€å‘ç¯å¢ƒï¼Œè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç”¨äºä¼ å…¥æ ¹ç›®å½•index.htmlæ–‡ä»¶è¯»å–</span></span>
<span class="line">        <span class="token comment">// å¦‚æœä¸åŒè¯­è¨€æœ‰åŒæ ·çš„moduleName,åªç”¨ç¬¬ä¸€ä¸ªï¼›dirs[0]</span></span>
<span class="line">        <span class="token comment">// ä¸ºäº†é€‚é…windowsæ‰€ä»¥é‡‡ç”¨path.relativeç”Ÿæˆç›¸å¯¹è·¯å¾„</span></span>
<span class="line">        <span class="token comment">// path.resolve---ç”Ÿæˆç»å¯¹è·¯å¾„  E:\\02_private_project\\vortex-fe\\packages\\vue2\\modules\\home\\index.ts,è¿™æ˜¯fileåè®®ï¼Œæ²¡æœ‰è®¿é—®æƒé™çš„</span></span>
<span class="line">        process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_SCRIPT_SRC</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">relative</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dirs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// index.html</span></span>
<span class="line"><span class="token comment">// &lt;script type=&quot;module&quot; src=&quot;%VITE_SCRIPT_SRC%&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è·å–buildæ—¶çš„å¤šå…¥å£æ–‡ä»¶åˆ—è¡¨" tabindex="-1"><a class="header-anchor" href="#è·å–buildæ—¶çš„å¤šå…¥å£æ–‡ä»¶åˆ—è¡¨"><span>è·å–buildæ—¶çš„å¤šå…¥å£æ–‡ä»¶åˆ—è¡¨</span></a></h3><ul><li>viteå…¥å£æ–‡ä»¶æ˜¯index.html,æ”¯æŒå¤šå…¥å£ï¼Œä½†æ˜¯æ”¯æŒçš„ä¹Ÿæ˜¯htmlæ–‡ä»¶</li><li>ä½†æ˜¯æˆ‘ä¸å¸Œæœ›æ¯ä¸ªé¡¹ç›®åˆ›å»ºä¸€ä¸ªhtmlæ–‡ä»¶</li><li>ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶æ¨¡æ¿ï¼Œè‡ªåŠ¨è®¾ç½®scriptå¼•ç”¨</li><li>è¿™æ–‡ä»¶ä¸è¦å†™å…¥ç£ç›˜ï¼Œå­˜åœ¨å†…å­˜ä¸­</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"></span>
<span class="line"><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">&#39;path&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">&#39;fs/promises&#39;</span><span class="token punctuation">;</span> <span class="token comment">// ä»éœ€è¯»å–æ¨¡æ¿æ–‡ä»¶</span></span>
<span class="line"><span class="token keyword">const</span> langs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;vue2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;vue3&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å½“å‰é¡¹ç›®æ”¯æŒçš„è¯­è¨€</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> htmlTemplatePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;index-template.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// buildæ—¶ä½¿ç”¨çš„htmlæ¨¡æ¿</span></span>
<span class="line"><span class="token keyword">const</span> scriptPlaceholder <span class="token operator">=</span> <span class="token string">&#39;&lt;!-- INJECT_SCRIPT --&gt;&#39;</span>    <span class="token comment">// buildæ—¶åŠ¨æ€æ’å…¥scriptæ ‡ç­¾çš„å ä½</span></span>
<span class="line"><span class="token keyword">const</span> generatedEntries <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token comment">// buildç”Ÿæˆè™šæ‹Ÿhtmlçš„åˆ—è¡¨</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>command<span class="token punctuation">,</span> mode<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> entries <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEntries</span><span class="token punctuation">(</span>dirs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–buildæ—¶çš„å…¥å£é…ç½®</span></span>
<span class="line">    <span class="token keyword">let</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">VirtualHtmlResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// è‡ªå®šä¹‰ç»„ä»¶ï¼Œç”¨äºè§£æbuildç”Ÿæˆçš„è™šæ‹Ÿhtml</span></span>
<span class="line">    <span class="token comment">// ...å…¶ä»–å®šåˆ¶æ’ä»¶ã€å…¬å…±æ’ä»¶</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">        plugins<span class="token punctuation">,</span>  <span class="token comment">// æ’ä»¶é…ç½®</span></span>
<span class="line">        <span class="token literal-property property">base</span><span class="token operator">:</span><span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span> <span class="token comment">// ç¼–è¯‘å®Œåæ–‡ä»¶å¼•å…¥çš„æ–¹å¼-ç›¸å¯¹è·¯å¾„</span></span>
<span class="line">        <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">rollupOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token literal-property property">input</span><span class="token operator">:</span> entries  <span class="token comment">// å®šä¹‰buildæ—¶å¤šå…¥å£-è™šæ‹Ÿæ–‡ä»¶</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string-property property">&#39;@packages&#39;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;packages&quot;</span><span class="token punctuation">)</span>   <span class="token comment">// ä¸ºäº†è§£å†³éƒ¨åˆ†ç³»ç»Ÿä¸‹è·¯å¾„è§£è¯»è®¿é—®ä¸åŒ</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// å‡†å¤‡ç”Ÿæˆè™šæ‹Ÿhtmlç›®å½•åˆ—è¡¨</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token parameter">dirs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 1. è¯»å–å¹¶ç¼“å­˜ HTML æ¨¡æ¿</span></span>
<span class="line">    <span class="token keyword">let</span> templateContent <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>htmlTemplatePath<span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>templateContent<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>scriptPlaceholder<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">è­¦å‘Šï¼šHTML æ¨¡æ¿æ–‡ä»¶ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>htmlTemplatePath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ä¸­æœªæ‰¾åˆ°å ä½ç¬¦ &#39;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>scriptPlaceholder<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&#39;ã€‚</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// å…¥å£æ–‡ä»¶å¯ä»¥æ˜¯ä¸ª string []ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥returnäº†ï¼›</span></span>
<span class="line">    <span class="token keyword">return</span> dirs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">const</span> relativeToPackages <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">relative</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;packages&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> filePath<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// ä½¿ç”¨posixé£æ ¼ï¼ˆå…¼å®¹ Unix/Linux å’Œ Windowsï¼‰</span></span>
<span class="line">        <span class="token keyword">const</span> tsPath <span class="token operator">=</span> path<span class="token punctuation">.</span>posix<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;@packages&#39;</span><span class="token punctuation">,</span> relativeToPackages<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">const</span> htmlContent <span class="token operator">=</span> templateContent<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span></span>
<span class="line">            scriptPlaceholder<span class="token punctuation">,</span></span>
<span class="line">            <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;script type=&quot;module&quot; src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>tsPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;&lt;/script&gt;</span><span class="token template-punctuation string">\`</span></span> <span class="token comment">// ä½¿ç”¨ç»å¯¹è·¯å¾„ / å¼€å¤´æ›´å®‰å…¨</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// path.basename(path[, ext]) ä»ä¸€ä¸ªå®Œæ•´è·¯å¾„ï¼ˆæ— è®ºæ˜¯æ–‡ä»¶è·¯å¾„è¿˜æ˜¯ç›®å½•è·¯å¾„ï¼‰ä¸­æå–å‡ºæœ€åä¸€éƒ¨åˆ†</span></span>
<span class="line">        <span class="token comment">// path.basename(tsPath, path.extname(tsPath)),ä»tsPathè·å–æœ€åä¸€éƒ¨åˆ†å¹¶ä¸”å»é™¤åç¼€åï¼Œè¿™é‡Œçš„ç»“æœæ˜¯index</span></span>
<span class="line">        <span class="token comment">// path.dirname(tsPath)ï¼šè·å–tsPathæ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„ï¼šxxxx/home/index.ts ==&gt; xxxx/home</span></span>
<span class="line">        <span class="token keyword">const</span> dirName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>tsPath<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// xxxx/homeè·å–æœ€åä¸€éƒ¨åˆ†==&gt;home</span></span>
<span class="line">        <span class="token keyword">const</span> tsFileName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>dirName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// æˆ‘è¿™é‡Œæ²¡æœ‰åˆ›å»ºæ–‡ä»¶ï¼Œåªæ˜¯æŠŠæ–‡ä»¶å†…å®¹å­˜åœ¨generatedEntriesé‡Œ</span></span>
<span class="line">        <span class="token comment">// æ€ä¹ˆå®ç°è®©viteè®¤è¯†å‘¢ï¼Ÿï¼Ÿ</span></span>
<span class="line">        <span class="token comment">// ä½¿ç”¨è‡ªå®šä¹‰æ’ä»¶ï¼šç”¨æ—¶é—´é’©å­ï¼Œåœ¨viteè¯»å–åˆ°æˆ‘çš„tsFileNameçš„æ—¶å€™ï¼Œå°†htmlContentåå‡ºå» --- ä¸‹é¢çš„VirtualHtmlResolveræ’ä»¶ï¼›</span></span>
<span class="line">        generatedEntries<span class="token punctuation">[</span>tsFileName<span class="token punctuation">]</span> <span class="token operator">=</span> htmlContent<span class="token punctuation">;</span>  <span class="token comment">// è™šæ‹Ÿåˆ—è¡¨</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>tsFileName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.html</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">VirtualHtmlResolver</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;virtual-html-resolver&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token comment">// resolveId é’©å­ç”¨äºè§£æè™šæ‹Ÿæ¨¡å—ID</span></span>
<span class="line">        <span class="token function">resolveId</span><span class="token punctuation">(</span><span class="token parameter">tsPath</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span><span class="token punctuation">(</span>generatedEntries<span class="token punctuation">[</span>tsPath<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">return</span> tsPath<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token keyword">null</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token comment">// loadè·¯å¾„æ–‡ä»¶æ—¶ï¼Œä»è™šæ‹Ÿåˆ—è¡¨generatedEntriesä¸­è¯»å–returnï¼›</span></span>
<span class="line">        <span class="token function">load</span><span class="token punctuation">(</span><span class="token parameter">tsPath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">let</span> tsFileName <span class="token operator">=</span> tsPath<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">return</span> generatedEntries<span class="token punctuation">[</span>tsFileName<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é…ç½®å®šåˆ¶æ’ä»¶" tabindex="-1"><a class="header-anchor" href="#é…ç½®å®šåˆ¶æ’ä»¶"><span>é…ç½®å®šåˆ¶æ’ä»¶</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> vue2 <span class="token keyword">from</span> <span class="token string">&quot;@vitejs/plugin-vue2&quot;</span>  <span class="token comment">// vue2.7ä½¿ç”¨viteéœ€è¦çš„æ’ä»¶</span></span>
<span class="line"><span class="token comment">// ...å¼•å…¥å…¶ä»–è¯­è¨€çš„å®šåˆ¶æ’ä»¶</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>command<span class="token punctuation">,</span> mode<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// å…¬å…±æ’ä»¶</span></span>
<span class="line">    plugins <span class="token operator">=</span> <span class="token function">getPlugins</span><span class="token punctuation">(</span>dirs<span class="token punctuation">,</span> plugins<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// å„ä¸ªè¯­è¨€å®šåˆ¶æ’ä»¶</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token operator">...</span><span class="token punctuation">,</span></span>
<span class="line">        plugins</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// è·å–æ’ä»¶åˆ—è¡¨</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">getPlugins</span> <span class="token punctuation">(</span><span class="token parameter">dirs<span class="token punctuation">,</span> plugins</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token comment">// vue2çš„æ’ä»¶</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>dirs<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token operator">=&gt;</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">vue2</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        arr <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">            <span class="token function">vue2</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// vue3çš„æ’ä»¶</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>dirs<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token operator">=&gt;</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">vue3</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// reactçš„æ’ä»¶</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>dirs<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token operator">=&gt;</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">react</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> plugins<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,26)])])}const i=s(t,[["render",l]]),u=JSON.parse('{"path":"/mds/buildTools/vite.html","title":"Vite","lang":"en-US","frontmatter":{},"git":{},"filePathRelative":"mds/buildTools/vite.md"}');export{i as comp,u as data};
