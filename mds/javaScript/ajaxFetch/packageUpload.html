<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>前端笔记</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-C5QREZ3P.css" as="style"><link rel="stylesheet" href="/assets/style-C5QREZ3P.css">
    <link rel="modulepreload" href="/assets/app-D6TqyvMs.js"><link rel="modulepreload" href="/assets/packageUpload.html-CGLHFj7u.js">
    <link rel="prefetch" href="/assets/index.html-BcZd1lvp.js" as="script"><link rel="prefetch" href="/assets/flutter.html-B09vP2oB.js" as="script"><link rel="prefetch" href="/assets/javascript.html-TUHoYsiS.js" as="script"><link rel="prefetch" href="/assets/loginNginx.html-BVywJNyX.js" as="script"><link rel="prefetch" href="/assets/mysql.html-Bcf30ZtN.js" as="script"><link rel="prefetch" href="/assets/nginx.html-128XVq0x.js" as="script"><link rel="prefetch" href="/assets/react.html-BaDBqkrW.js" as="script"><link rel="prefetch" href="/assets/server.html-JgIvPMXH.js" as="script"><link rel="prefetch" href="/assets/gulp.html-J5QChLu9.js" as="script"><link rel="prefetch" href="/assets/npm.html-W-5yHm1N.js" as="script"><link rel="prefetch" href="/assets/vite.html-CrSzeqR3.js" as="script"><link rel="prefetch" href="/assets/webpack-dev-conf.html-Dv_5GTMz.js" as="script"><link rel="prefetch" href="/assets/webpack.html-HRDcK3bw.js" as="script"><link rel="prefetch" href="/assets/brew.html-DSIa35tp.js" as="script"><link rel="prefetch" href="/assets/git.html-BoZqCUHu.js" as="script"><link rel="prefetch" href="/assets/node.html-ChlNFiPz.js" as="script"><link rel="prefetch" href="/assets/nvm.html-DVvFK9OD.js" as="script"><link rel="prefetch" href="/assets/basejieshao.html-Sd0zluD0.js" as="script"><link rel="prefetch" href="/assets/sass.html-9nidoaOD.js" as="script"><link rel="prefetch" href="/assets/vue2.html-CZeVJ9to.js" as="script"><link rel="prefetch" href="/assets/vue2_project.html-DlwYTE0m.js" as="script"><link rel="prefetch" href="/assets/vue2_router.html-RpKMJYMA.js" as="script"><link rel="prefetch" href="/assets/vue2_vuex.html-CSDFLmPe.js" as="script"><link rel="prefetch" href="/assets/vue3.html-CreKIZcH.js" as="script"><link rel="prefetch" href="/assets/AjaxXML.html-ciq0smEM.js" as="script"><link rel="prefetch" href="/assets/asyncawait.html-DtIKP4cH.js" as="script"><link rel="prefetch" href="/assets/crossOrigin.html-1CO4zoNR.js" as="script"><link rel="prefetch" href="/assets/fetch.html-BB4-L1_B.js" as="script"><link rel="prefetch" href="/assets/Generator.html-B_mSiFAj.js" as="script"><link rel="prefetch" href="/assets/Promise.html-vT4nvGPv.js" as="script"><link rel="prefetch" href="/assets/console.html-COTArx2o.js" as="script"><link rel="prefetch" href="/assets/history.html-CLHu8jhg.js" as="script"><link rel="prefetch" href="/assets/location.html-BmGQvwlF.js" as="script"><link rel="prefetch" href="/assets/Navigator.html-WKLP-8hA.js" as="script"><link rel="prefetch" href="/assets/window.html-Bjab9cuA.js" as="script"><link rel="prefetch" href="/assets/anime.html-YJkHvvsW.js" as="script"><link rel="prefetch" href="/assets/baseEvent.html-Bz9gU_DG.js" as="script"><link rel="prefetch" href="/assets/DOM.html-FKuCeGoG.js" as="script"><link rel="prefetch" href="/assets/DOMNode.html-CoHXAfqB.js" as="script"><link rel="prefetch" href="/assets/domPosition.html-CIeCS6mB.js" as="script"><link rel="prefetch" href="/assets/highEvent.html-BgHmp-lK.js" as="script"><link rel="prefetch" href="/assets/localStroge.html-DrzPkZX1.js" as="script"><link rel="prefetch" href="/assets/operaForm.html-DFszINbo.js" as="script"><link rel="prefetch" href="/assets/phoneEvent.html-BfzXsjQY.js" as="script"><link rel="prefetch" href="/assets/arr.html-CBjcjnYT.js" as="script"><link rel="prefetch" href="/assets/debugError.html-D5CWrULl.js" as="script"><link rel="prefetch" href="/assets/Map.html-Do1VFh8c.js" as="script"><link rel="prefetch" href="/assets/phoneDebug.html-Krq9UfI1.js" as="script"><link rel="prefetch" href="/assets/processControl.html-C1pPHcSI.js" as="script"><link rel="prefetch" href="/assets/Set.html-9lVsKrK8.js" as="script"><link rel="prefetch" href="/assets/Symbol.html-qPIExdtd.js" as="script"><link rel="prefetch" href="/assets/transferDataType.html-CtTNwgYw.js" as="script"><link rel="prefetch" href="/assets/var_dateType.html-UFd2wzME.js" as="script"><link rel="prefetch" href="/assets/yunsuanfu.html-Br7YWDRC.js" as="script"><link rel="prefetch" href="/assets/collect.html-C5Zl-xaE.js" as="script"><link rel="prefetch" href="/assets/designMode.html-D-EMGqrC.js" as="script"><link rel="prefetch" href="/assets/moduleDev.html-DhrnizZB.js" as="script"><link rel="prefetch" href="/assets/storage.html-BUzDIVEU.js" as="script"><link rel="prefetch" href="/assets/strict.html-B_kNxRav.js" as="script"><link rel="prefetch" href="/assets/suanfa.html-D94EeJ8C.js" as="script"><link rel="prefetch" href="/assets/webSocket.html-Cx_oZ9q5.js" as="script"><link rel="prefetch" href="/assets/argument_return.html-CpkrXZJE.js" as="script"><link rel="prefetch" href="/assets/highfunc.html-C5Wx-LTa.js" as="script"><link rel="prefetch" href="/assets/varfunc.html-DVQZm8d4.js" as="script"><link rel="prefetch" href="/assets/zuoyongyu.html-ejqbcARi.js" as="script"><link rel="prefetch" href="/assets/Array.html-XEWGRbf0.js" as="script"><link rel="prefetch" href="/assets/Class.html-HqTY595E.js" as="script"><link rel="prefetch" href="/assets/Date.html-yHlGSorm.js" as="script"><link rel="prefetch" href="/assets/faceObjectCode.html-Dz_K20C2.js" as="script"><link rel="prefetch" href="/assets/Math.html-DkgXhtE1.js" as="script"><link rel="prefetch" href="/assets/Object.html-tVF0SArq.js" as="script"><link rel="prefetch" href="/assets/objectbase.html-CKx0EibA.js" as="script"><link rel="prefetch" href="/assets/objectSpecial.html-C-7sOL91.js" as="script"><link rel="prefetch" href="/assets/reg.html-CyGCCaWA.js" as="script"><link rel="prefetch" href="/assets/String.html-XwryKtpd.js" as="script"><link rel="prefetch" href="/assets/404.html-Bx9sDhMU.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">前端笔记</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><!----><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading"> <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div id="content"><h2 id="ajax-封装" tabindex="-1"><a class="header-anchor" href="#ajax-封装"><span>Ajax 封装</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 兼容实例化一个ajax对象</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">newAjax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> xhr <span class="token operator">=</span> window<span class="token punctuation">.</span>XMLHttpRequest<span class="token operator">?</span><span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">&quot;Miscrosoft.XMLHTTP&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> xhr<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//ajax函数</span></span>
<span class="line">  <span class="token comment">//1. type:方式 &quot;get&quot; &quot;post&quot;</span></span>
<span class="line">  <span class="token comment">//2. url:地址 url &quot;demo.php&quot;</span></span>
<span class="line">  <span class="token comment">//3.data:数据  &quot;id=0&amp;name=zhangsan&quot;</span></span>
<span class="line">  <span class="token comment">//4.asynch:是否异步  true  false</span></span>
<span class="line">  <span class="token comment">//5.dataType:返回数据的格式 &quot;text&quot; &quot;json&quot; &quot;xml&quot;</span></span>
<span class="line">  <span class="token comment">//6.success返回数据之后进行的操作  function(){}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">//没有url 直接退出</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;请输入URL&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">var</span> type <span class="token operator">=</span> options<span class="token punctuation">.</span>type <span class="token operator">||</span> <span class="token string">&#39;GET&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">var</span> async <span class="token operator">=</span> options<span class="token punctuation">.</span>async<span class="token operator">==</span><span class="token keyword">undefined</span><span class="token operator">?</span><span class="token boolean">true</span><span class="token operator">:</span>options<span class="token punctuation">.</span>async<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">var</span> dataType <span class="token operator">=</span> options<span class="token punctuation">.</span>dataType <span class="token operator">||</span> <span class="token string">&#39;text&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">var</span> dataStr <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> options<span class="token punctuation">.</span>data<span class="token operator">==</span><span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">            dataStr <span class="token operator">=</span> options<span class="token punctuation">.</span>data<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">//{user:123,pwd:456}</span></span>
<span class="line">            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> options<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                 dataStr<span class="token operator">+=</span> i<span class="token operator">+</span><span class="token string">&#39;=&#39;</span><span class="token operator">+</span>options<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">&#39;&amp;&#39;</span></span>
<span class="line">                <span class="token comment">//user=123&amp;pwd=456&amp;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            dataStr <span class="token operator">=</span> dataStr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//dataStr = &quot;user=123&amp;pwd=456&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>dataStr<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">            xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span>options<span class="token punctuation">.</span>url<span class="token operator">+</span><span class="token string">&#39;?&#39;</span><span class="token operator">+</span>dataStr<span class="token punctuation">,</span>async<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span></span>
<span class="line">            xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span>options<span class="token punctuation">.</span>url<span class="token punctuation">,</span>async<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token string">&#39;POST&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>options<span class="token punctuation">.</span>url<span class="token punctuation">,</span>async<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;application/x-www-form-urlencoded;charset=utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>dataStr<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState<span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">if</span><span class="token punctuation">(</span>dataType<span class="token operator">==</span><span class="token string">&#39;text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                    options<span class="token punctuation">.</span>success<span class="token operator">&amp;&amp;</span>options<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>dataType<span class="token operator">==</span><span class="token string">&#39;xml&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                    options<span class="token punctuation">.</span>success<span class="token operator">&amp;&amp;</span>options<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseXML<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>dataType<span class="token operator">==</span><span class="token string">&#39;json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                    options<span class="token punctuation">.</span>success<span class="token operator">&amp;&amp;</span>options<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">==</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;请求失败&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ajax大规模数据处理" tabindex="-1"><a class="header-anchor" href="#ajax大规模数据处理"><span>ajax大规模数据处理</span></a></h2><blockquote><p>假设ajax要请求一条长度10000的数据并渲染,首先由于数据量大ajax请求花费事件会很长,并且前台在处理该数据时也会花费大量事件导致页面长时间留白。所以在请求大规模数据时有以下几种处理方法：</p></blockquote><h3 id="_1-数据分页" tabindex="-1"><a class="header-anchor" href="#_1-数据分页"><span>1. 数据分页</span></a></h3><p>将大量的数据进行分页展示，每次只获取当前页的数据，则数据的请求和处理会更快。</p><p>所以在发送ajax请求时就需要携带分页的参数，一个分页器一般包含<code>数据总条数</code>、<code>总页数</code>、<code>当前页码</code>、<code>每页数据条数</code>等数据。其中<strong>当前页码</strong>、<strong>每页条数</strong>需要在发送请求时携带，每当切换页码时重新携带当前页码和每页条数发送请求。</p><p>而后台需要返回<strong>当前页数据</strong>，以及<strong>数据总条数</strong>，前台即可根据<code>数据总条数</code>及<code>每页数据条数</code>计算出<code>总页数</code>进行页面渲染。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> currentPage <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   <span class="token comment">// 当前页码</span></span>
<span class="line">    pageSize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>     <span class="token comment">// 每页数据条数   </span></span>
<span class="line"><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="line">        currentPage<span class="token punctuation">,</span>  </span>
<span class="line">        pageSize<span class="token punctuation">,</span>   </span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">var</span> pageCount <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>total <span class="token operator">/</span> pageSize<span class="token punctuation">)</span>   <span class="token comment">// 总数据条数total / 每页数据数pageSize   向上取整，即可求出总页数pageCount</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-分批次请求" tabindex="-1"><a class="header-anchor" href="#_2-分批次请求"><span>2. 分批次请求</span></a></h3><p>当前台不能进行分页时，大规模数据的请求可采用分批次的请求。如10000条数据，第一次请求100条数据（这样用户就很快看到有页面出来），剩余的数据，通过ajax分多次请求给客户端。（这里相当于：用户的一个请求结果，被切割成多次请求来完成）</p><p>例如先展示100条数据，剩余数据按需(上拉或者触底)加载</p><h2 id="文件上传" tabindex="-1"><a class="header-anchor" href="#文件上传"><span>文件上传</span></a></h2><h3 id="_1-form文件上传" tabindex="-1"><a class="header-anchor" href="#_1-form文件上传"><span>1. form文件上传</span></a></h3><blockquote><p>上传图片必须为<code>POST</code>方式，并且设置编码方式<code>enctype=&quot;multipart/form-data&quot;</code>，否则会默认对文件进行编码则无法使用<br> enctype这个属性管理的是表单的MIME编码，有三个值，默认为<code>application/x-www-form-urlencoded</code>，是传递html代码的编码类型。<code>text/plain</code>,是纯文本传输的意思。<code>multipart/form-data</code>,是用来指定传输数据的特殊类型的，主要就是我们上传的非文本的内容，比如图片或者mp3等等。</p></blockquote><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code class="language-html"><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multipart/form-data<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-ajax上传文件" tabindex="-1"><a class="header-anchor" href="#_2-ajax上传文件"><span>2. Ajax上传文件</span></a></h3><blockquote><p>Ajax上传文件需要依靠表单对象<code>FormData</code>，在表单对象中添加数据进行上传</p></blockquote><p>表单对象<code>FormData</code>的作用</p><ul><li>将form表单元素的name与value进行组合，实现表单数据的序列化，从而减少表单元素的拼接，提高工作效率。</li><li>异步上传文件<br> 兼容性：Chrome 7+、Firefox 4+、IE 10+、Opera 12+、Safari 5+。</li></ul><h4 id="formdata对象" tabindex="-1"><a class="header-anchor" href="#formdata对象"><span>formData对象</span></a></h4><p>实例化formData，来得到这个对象</p><p>参数为form，一个HTML表单元素，可以包含任何形式的表单控件，包括文件输入框，是一个可选参数</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>通过HTML表单创建FormData对象</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;form&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//包含了form表单里的数据</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="方法" tabindex="-1"><a class="header-anchor" href="#方法"><span>方法</span></a></h5><ul><li>通过append(name,value,filename)在数据末尾追加数据，参数值有三个,第三个为可选参数</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">formdata<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;laoliu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//通过append()方法在末尾追加key为name值为laoliu的数据</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>通过get(name)来获取相对应的值</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 获取key为age的值</span></span>
<span class="line">formdata<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>通过set(key, value)来设置修改数据（key的值不存在，会添加一条数据）</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">formdata<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;laoli&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>通过has(key)来判断是否存在对应的key值 返回一个布尔值</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">formdata<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>     </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>通过delete(key)可以删除数据</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">//删除key为name的值</span></span>
<span class="line">formdata<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ajax-formdata对象上传文件" tabindex="-1"><a class="header-anchor" href="#ajax-formdata对象上传文件"><span>Ajax+FormData对象上传文件</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> fileTag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;input[type=file]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> file<span class="token punctuation">.</span><span class="token function-variable function">onchange</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 图片会保存到 标签的files属性中，并且可读取文件的名称、大小等信息</span></span>
<span class="line">    <span class="token keyword">var</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 添加图片，字段名叫 files</span></span>
<span class="line">    fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#39;files&#39;</span><span class="token punctuation">,</span> fileTag<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 添加普通字段</span></span>
<span class="line">    fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//数字22会被立即转换成字符串 &quot;22&quot;</span></span>
<span class="line">    <span class="token comment">// ...ajax代码</span></span>
<span class="line">    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">// ...ajax代码</span></span>
<span class="line"> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="轮询" tabindex="-1"><a class="header-anchor" href="#轮询"><span>轮询</span></a></h2><blockquote><p>原理： 每隔一段时间执行ajax请求，获取实时数据</p></blockquote><p>例：访问实时金价、实时停车等数据</p><p>实现方式：在时间函数<code>setInterval</code>中进行ajax请求</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-D6TqyvMs.js" defer></script>
  </body>
</html>
